<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WOS Alliance - Planning & Info</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        /* Copy button styles */
        .copy-button { position: absolute; top: 10px; right: 10px; background: rgba(100, 181, 246, 0.9); border: none; padding: 8px 15px; border-radius: 5px; color: white; cursor: pointer; font-size: 0.9em; transition: all 0.3s ease; display: flex; align-items: center; gap: 5px; }
        .copy-button:hover { background: rgba(33, 150, 243, 0.9); transform: translateY(-2px); }
        .copy-button.copied { background: rgba(76, 175, 80, 0.9); }
        .copyable-section { position: relative; padding-top: 15px; }
        /* Navigation Menu */
        .nav-menu { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(30, 30, 30, 0.95); backdrop-filter: blur(10px); padding: 15px 20px; border-radius: 30px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5); z-index: 1000; display: flex; gap: 15px; overflow-x: auto; max-width: 90vw; scrollbar-width: none; -ms-overflow-style: none; }
        .nav-menu::-webkit-scrollbar { display: none; }
        .nav-item { background: rgba(100, 181, 246, 0.2); border: 1px solid rgba(100, 181, 246, 0.3); padding: 10px 20px; border-radius: 20px; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-size: 0.9em; text-decoration: none; color: #e8e8e8; display: inline-block; }
        .nav-item:hover { background: rgba(100, 181, 246, 0.4); transform: translateY(-2px); }
        /* Mobile responsive navigation */
        @media (max-width: 768px) { .nav-menu { padding: 10px 15px; gap: 10px; bottom: 10px; } .nav-item { padding: 8px 15px; font-size: 0.85em; } }
        /* Hidden content for copying */
        .hidden-copy-content { position: absolute; left: -9999px; visibility: hidden; }
        body { font-family: 'Arial', sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 50%, #16213e 100%); min-height: 100vh; color: #e8e8e8; position: relative; overflow-x: hidden; }
        /* Snow effect */
        .snow { position: fixed; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        .snow::before, .snow::after { content: ''; position: absolute; top: -10%; left: 0; width: 100%; height: 110%; background-image: radial-gradient(2px 2px at 20% 30%, white, transparent), radial-gradient(2px 2px at 60% 70%, white, transparent), radial-gradient(1px 1px at 90% 10%, white, transparent), radial-gradient(1px 1px at 30% 80%, white, transparent); background-size: 300px 200px; animation: snow 10s linear infinite; opacity: 0.8; }
        .snow::after { animation-duration: 15s; animation-delay: 5s; opacity: 0.6; }
        @keyframes snow { from { transform: translateY(-100px); } to { transform: translateY(100vh); } }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; position: relative; z-index: 2; }
        header { text-align: center; margin-bottom: 40px; padding: 30px 0; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.2); position: relative; }
        header::before { content: ''; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 200px; height: 200px; background-image: url('https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/svg/2744.svg'); background-size: contain; background-repeat: no-repeat; opacity: 0.1; z-index: -1; }
        h1 { font-size: 3em; color: #fff; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 30px rgba(100, 200, 255, 0.5); margin-bottom: 10px; font-weight: bold; letter-spacing: 2px; }
        h2 { font-size: 1.8em; color: #64b5f6; margin: 20px 0 15px 0; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); display: flex; align-items: center; gap: 10px; }
        h3 { font-size: 1.3em; color: #90caf9; margin: 15px 0 10px 0; }
        .icon { width: 30px; height: 30px; display: inline-block; }
        .section { background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(5px); padding: 25px; margin-bottom: 25px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.15); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .section:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4); }
        .events-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .event-card { background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px; border: 1px solid rgba(100, 181, 246, 0.3); position: relative; overflow: hidden; }
        .event-card::before { content: ''; position: absolute; top: -2px; left: -2px; right: -2px; bottom: -2px; background: linear-gradient(45deg, #64b5f6, #1976d2, #64b5f6); border-radius: 10px; opacity: 0; z-index: -1; transition: opacity 0.3s ease; }
        .event-card:hover::before { opacity: 0.3; }
        .time-slot { background: rgba(25, 118, 210, 0.3); padding: 10px; margin: 5px 0; border-radius: 5px; display: flex; align-items: center; gap: 10px; border-left: 3px solid #64b5f6; }
        .facilities-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px; margin-top: 20px; }
        .facility-card { background: rgba(255, 255, 255, 0.05); padding: 20px; border-radius: 10px; border: 1px solid rgba(255, 255, 255, 0.1); }
        .facility-item { padding: 12px; margin: 8px 0; background: rgba(255, 255, 255, 0.03); border-radius: 5px; border-left: 3px solid #4caf50; transition: background 0.3s ease; }
        .facility-item:hover { background: rgba(255, 255, 255, 0.08); }
        .rotation { color: #ffd54f; font-weight: bold; font-size: 0.9em; margin-left: 10px; }
        .coordinates { color: #81c784; font-size: 0.9em; margin-left: 10px; }
        .must-get { background: rgba(255, 87, 34, 0.2); border: 2px solid #ff5722; padding: 20px; border-radius: 10px; margin-top: 20px; }
        .must-get h3 { color: #ff7043; }
        .must-get-item { padding: 10px; margin: 5px 0; background: rgba(255, 87, 34, 0.1); border-radius: 5px; border-left: 3px solid #ff5722; }
        .clock { display: inline-flex; align-items: center; gap: 5px; font-weight: bold; color: #64b5f6; }
        .hero-list { background: rgba(255, 255, 255, 0.03); padding: 15px; border-radius: 8px; margin: 10px 0; }
        .hero-item { padding: 8px; margin: 5px 0; border-left: 3px solid #4caf50; padding-left: 15px; }
        .warning-box { background: rgba(255, 193, 7, 0.2); border: 2px solid #ffc107; padding: 15px; border-radius: 8px; margin: 15px 0; font-weight: bold; text-align: center; }
        .rule-box { background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #64b5f6; }
        .rule-box ul { list-style: none; padding-left: 0; }
        .rule-box li { padding: 8px 0; position: relative; padding-left: 25px; }
        .rule-box li::before { content: '‚ñ∏'; position: absolute; left: 0; color: #64b5f6; }
        .svs-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px; }
        .svs-item { background: rgba(255, 255, 255, 0.05); padding: 10px 15px; border-radius: 5px; border-left: 3px solid #9c27b0; display: flex; align-items: center; gap: 10px; }
        .svs-item::before { content: 'üíé'; font-size: 1.2em; }
        @media (max-width: 768px) { h1 { font-size: 2em; } .container { padding: 10px; } .section { padding: 15px; } .svs-grid { grid-template-columns: 1fr; } }

        /* ===== Blacklist section styles ===== */
        .search-bar { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-top: 10px; }
        .search-input { flex: 1; min-width: 240px; padding: 10px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.06); color: #e8e8e8; outline: none; }
        .search-input::placeholder { color: #bcd3f6; }
        .reset-btn { padding: 10px 14px; border-radius: 8px; background: rgba(100,181,246,0.25); border: 1px solid rgba(100,181,246,0.45); color: #e8e8e8; cursor: pointer; }
        .reset-btn:hover { background: rgba(100,181,246,0.4); }
        .table-wrap { overflow-x: auto; margin-top: 15px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.12); }
        table { width: 100%; border-collapse: collapse; background: rgba(255,255,255,0.03); }
        thead th { text-align: left; padding: 12px; font-weight: 700; color: #90caf9; border-bottom: 1px solid rgba(255,255,255,0.12); }
        tbody td { padding: 10px 12px; border-top: 1px solid rgba(255,255,255,0.08); }
        tbody tr:hover { background: rgba(255,255,255,0.04); }
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
        .pill { display: inline-block; padding: 2px 8px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.06); font-size: .85em; }
        .count-chip { margin-left: 8px; font-size: .85em; opacity: .85; }
        .small { font-size: .9em; opacity: .9; }
    </style>
</head>
<body>
    <div class="snow"></div>
    <div class="container">
        <header>
            <h1>‚ùÑÔ∏è WHITEOUT SURVIVAL ‚ùÑÔ∏è</h1>
            <p style="font-size: 1.2em; color: #90caf9; margin-top: 10px;">Alliance Planning & Information Hub</p>
        </header>

        <!-- Event Times Section -->
        <section class="section" id="event-schedule">
            <h2>üìÖ Event Schedule & Favorite Votes</h2>
            <div class="events-grid">
                <div class="event-card"><h3>üêª Bear Traps</h3><div class="time-slot"><span class="clock">üïê 1.</span> 13:00 UTC</div><div class="time-slot"><span class="clock">üïê 2.</span> 19:00 UTC</div></div>
                <div class="event-card"><h3>üÉè Crazy Joe (CJ)</h3><div class="time-slot"><span class="clock">üïê 1.</span> 12:30 UTC</div><div class="time-slot"><span class="clock">üïê 2.</span> 18:30 UTC</div></div>
                <div class="event-card"><h3>‚öîÔ∏è Mercenary Boss</h3><div class="time-slot"><span class="clock">üïê</span> 13:00 UTC</div></div>
            </div>
        </section>

        <!-- Bear Traps Detailed Rules -->
        <section class="section" id="bear-traps">
            <h2>üêª Bear Traps - Formation & Rules</h2>
            <h3>Trap Joining Formations</h3>
            <div class="hero-list copyable-section" id="hero-formations">
                <button class="copy-button" onclick="copyToClipboard('hero-formations')">üìã Copy</button>
                <div class="hero-item">Jeronimo - any hero - any hero</div>
                <div class="hero-item">Jessie - any hero - any hero</div>
                <div class="hero-item">Jasser - any hero - any hero</div>
                <div class="hero-item">Sheoon - any hero - any hero</div>
                <div class="hero-item">Reina - any hero - any hero</div>
                <div class="hero-item">Philly - any hero - any hero</div>
                <div class="hidden-copy-content">‚ö†Ô∏è When joining High damage Rallies please only use the top 4 heroes mentioned ‚ö†Ô∏è
Join with ONLY troops if you do not have these heroes.</div>
            </div>
            <div class="warning-box">‚ö†Ô∏è When joining High damage Rallies please only use the top 4 heroes mentioned ‚ö†Ô∏è<br>Join with ONLY troops if you do not have these heroes.</div>
            <h3>üêª Bear Rules üêª</h3>
            <div class="rule-box copyable-section" id="bear-rules">
                <button class="copy-button" onclick="copyToClipboard('bear-rules')">üìã Copy</button>
                <strong>OPEN Your RALLY:</strong>
                <ul>
                    <li>3 best heroes with full army + best hero gear</li>
                    <li>Join with ~100k troops only and the correct joining heroes (check list)</li>
                    <li>Troop ratios: 20k-20k-60k or 10k-10k-80k</li>
                    <li>Send more marksmen - they deal the damage towards bear</li>
                </ul>
            </div>
        </section>

        <!-- Mercenary Boss Rules -->
        <section class="section" id="mercenary-boss">
            <h2>‚öîÔ∏è Mercenary Boss - Strategy</h2>
            <div class="rule-box copyable-section" id="mercenary-rules">
                <button class="copy-button" onclick="copyToClipboard('mercenary-rules')">üìã Copy</button>
                <ul>
                    <li>Attack with only 1 Unit until everyone did a hit</li>
                    <li>Wait for R4/R5 call for full strength attack</li>
                    <li>This ensures everyone can benefit from the rewards</li>
                </ul>
            </div>
        </section>

        <!-- Facilities Section -->
        <section class="section" id="facilities">
            <h2>üè≠ Facilities Status & Rotation</h2>
            <div class="facilities-grid">
                <div class="facility-card"><h3>üî¨ Technology</h3><div class="facility-item">Level 1 Technology: +5%</div><div class="facility-item">Level 3 Technology: +8%</div></div>
                <div class="facility-card"><h3>üó∫Ô∏è Expedition</h3><div class="facility-item">Level 3 Marchspeed: +15% <span class="rotation">‚ûú ETF ‚Üí NWO ‚Üí HAV</span></div></div>
                <div class="facility-card"><h3>üõ°Ô∏è Defense Facility</h3><div class="facility-item">Level 2 Defense: +5%</div><div class="facility-item">Level 4 Defense: +8% <span class="rotation">‚ûú ETF ‚Üí HAV ‚Üí Jst</span></div></div>
                <div class="facility-card"><h3>üéØ Training</h3><div class="facility-item">Level 2 Training Speed: +5%</div></div>
                <div class="facility-card"><h3>üèóÔ∏è Construction</h3><div class="facility-item">Level 3 Construction Speed: +8% <span class="rotation">‚ûú Jst ‚Üí HAV ‚Üí ETF</span></div><div class="facility-item">Level 1 Construction: +5% <em>(To Be Built)</em> <span class="coordinates">üìç X138 Y1038</span></div></div>
                <div class="facility-card"><h3>‚öîÔ∏è Weapons Facility</h3><div class="facility-item">Level 4 Attack: +8% <span class="rotation">‚ûú HAV ‚Üí NWO ‚Üí 300 ‚Üí ETF</span></div><div class="facility-item">Level 2 Attack: +5% <em>(To Be Built)</em> <span class="coordinates">üìç X438 Y1068</span></div></div>
            </div>
        </section>

        <!-- Priority Targets -->
        <section class="section must-get" id="priority">
            <h2 style="color: #ff7043;">üéØ Priority Targets - Must Get!</h2>
            <div class="must-get-item">üõ°Ô∏è Defense Level 1 & Level 3</div>
            <div class="must-get-item">‚öîÔ∏è Attack Level 1 & Level 3</div>
        </section>

        <!-- SvS Preparation -->
        <section class="section" id="svs-prep">
            <h2>‚öîÔ∏è SvS Prep Phase - Saving List</h2>
            <div class="svs-grid copyable-section" id="svs-list">
                <button class="copy-button" onclick="copyToClipboard('svs-list')">üìã Copy</button>
                <div class="svs-item">Fire crystals</div>
                <div class="svs-item">Construction speedups</div>
                <div class="svs-item">Training speedups</div>
                <div class="svs-item">Research speedups</div>
                <div class="svs-item">General speedups</div>
                <div class="svs-item">Diamonds for lucky wheel</div>
                <div class="svs-item">Mythic shards</div>
                <div class="svs-item">Stamina cans for beast hunts</div>
                <div class="svs-item">Essence stones</div>
                <div class="svs-item">Exclusive hero gear widgets</div>
                <div class="svs-item">Chief gear & charms upgrade items</div>
                <div class="svs-item">Pet advanced/common wild mark stones</div>
                <div class="svs-item">Dawn Academy items</div>
            </div>
        </section>

        <!-- ===== Blacklist Search (JSON DB) ===== -->
        <section class="section" id="blacklist">
            <h2>üö´ Alliance Blacklist (JSON)</h2>
            <p class="small">Client-side search across <span id="bl-count" class="count-chip">0</span> records. Keep the file <span class="pill mono">ids.json</span> in the same folder as this page.</p>
            <div class="search-bar">
                <input id="bl-search" class="search-input" type="search" placeholder="Search name, ID, or blacklisted by‚Ä¶ (e.g., Watson, 3349, ETF)" />
                <button id="bl-reset" class="reset-btn" type="button">Reset</button>
                <button id="bl-copy" class="reset-btn" type="button" title="Copy current results">Copy results</button>
            </div>
            <div class="table-wrap" style="margin-top:12px;">
                <table>
                    <thead>
                        <tr>
                            <th style="width:32%;">Name</th>
                            <th style="width:38%;">ID</th>
                            <th>Blacklisted By</th>
                        </tr>
                    </thead>
                    <tbody id="bl-tbody">
                        <tr><td colspan="3" style="padding:16px; opacity:.8;">Loading database‚Ä¶</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <!-- Navigation Menu -->
    <nav class="nav-menu">
        <a href="#event-schedule" class="nav-item">üìÖ Events</a>
        <a href="#bear-traps" class="nav-item">üêª Bear</a>
        <a href="#mercenary-boss" class="nav-item">‚öîÔ∏è Merc</a>
        <a href="#facilities" class="nav-item">üè≠ Facilities</a>
        <a href="#priority" class="nav-item">üéØ Priority</a>
        <a href="#svs-prep" class="nav-item">üíé SvS</a>
        <a href="#blacklist" class="nav-item">üö´ Blacklist</a>
    </nav>

    <script>
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const button = element.querySelector('.copy-button');
            let textToCopy = '';
            const children = element.childNodes;
            children.forEach(child => {
                if (child.nodeType === Node.TEXT_NODE) {
                    textToCopy += child.textContent.trim() + '\n';
                } else if (child.nodeType === Node.ELEMENT_NODE && !child.classList.contains('copy-button')) {
                    textToCopy += child.textContent.trim() + '\n';
                }
            });
            textToCopy = textToCopy.replace(/\n\s*\n/g, '\n').trim();
            navigator.clipboard.writeText(textToCopy).then(() => {
                button.innerHTML = '‚úì Copied!';
                button.classList.add('copied');
                setTimeout(() => { button.innerHTML = 'üìã Copy'; button.classList.remove('copied'); }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                button.innerHTML = '‚ùå Failed';
                setTimeout(() => { button.innerHTML = 'üìã Copy'; }, 2000);
            });
        }

        // ===== Blacklist DB + Search =====
        (function(){
            const DB_URL = 'ids.json'; // place ids.json next to this HTML file
            const $tbody = document.getElementById('bl-tbody');
            const $count = document.getElementById('bl-count');
            const $search = document.getElementById('bl-search');
            const $reset = document.getElementById('bl-reset');
            const $copy = document.getElementById('bl-copy');

            /** @type {{name:string,id:string,blacklistedBy:string}[]} */
            let DB = [];
            let VIEW = [];

            // Small debounce helper
            function debounce(fn, ms){ let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn.apply(null,args), ms); } }

            function normalize(s){ return (s||'').toString().toLowerCase().trim(); }

            function render(rows){
                $tbody.innerHTML = '';
                if (!rows.length){
                    $tbody.innerHTML = '<tr><td colspan="3" style="padding:16px; opacity:.8;">No matches.</td></tr>';
                    return;
                }
                const frag = document.createDocumentFragment();
                rows.forEach(r => {
                    const tr = document.createElement('tr');
                    const td1 = document.createElement('td');
                    const td2 = document.createElement('td');
                    const td3 = document.createElement('td');
                    td1.textContent = r.name;
                    td2.textContent = r.id; td2.className = 'mono';
                    td3.textContent = r.blacklistedBy; td3.className = 'pill';
                    tr.appendChild(td1); tr.appendChild(td2); tr.appendChild(td3);
                    frag.appendChild(tr);
                });
                $tbody.appendChild(frag);
            }

            function applySearch(){
                const q = normalize($search.value);
                if (!q){ VIEW = DB.slice(); render(VIEW); return; }
                VIEW = DB.filter(r => {
                    const n = normalize(r.name);
                    const i = normalize(r.id);
                    const b = normalize(r.blacklistedBy);
                    return n.includes(q) || i.includes(q) || b.includes(q);
                });
                render(VIEW);
            }

            const debouncedSearch = debounce(applySearch, 150);

            function copyResults(){
                if (!VIEW.length){ navigator.clipboard.writeText(''); return; }
                const lines = VIEW.map(r => `${r.name}\t${r.id}\t${r.blacklistedBy}`).join('\n');
                navigator.clipboard.writeText(lines);
            }

            $search.addEventListener('input', debouncedSearch);
            $reset.addEventListener('click', () => { $search.value = ''; applySearch(); $search.focus(); });
            $copy.addEventListener('click', () => { copyResults(); $copy.textContent = 'Copied'; setTimeout(()=> $copy.textContent = 'Copy results', 1200); });

            // Load DB from ids.json; if it fails, try inline fallback (optional)
            fetch(DB_URL, { cache: 'no-store' })
                .then(r => {
                    if (!r.ok) throw new Error('HTTP '+r.status);
                    return r.json();
                })
                .then(json => {
                    // Accept either array or object with .records
                    DB = Array.isArray(json) ? json : (json.records || []);
                    // Ensure shape + types (id as string)
                    DB = DB.map(x => ({
                        name: String(x.name || '').trim(),
                        id: String(x.id || '').trim(),
                        blacklistedBy: String(x.blacklistedBy || x.by || '').trim()
                    })).filter(x => x.name && x.id && x.blacklistedBy);
                    $count.textContent = DB.length;
                    VIEW = DB.slice();
                    render(VIEW);
                })
                .catch(err => {
                    console.warn('Failed to load ids.json. Using empty DB.', err);
                    DB = []; VIEW = []; $count.textContent = '0';
                    render([]);
                });
        })();
    </script>
</body>
</html>
